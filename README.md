# 🚀 Fast Install
本项目以Clash For Windows为例
---

还在为如何把配置好的绿色软件优雅地分享给朋友而烦恼吗？

> “喂，我把 Clash 发你了，记得解压后点那个小猫咪图标，然后...”

> “啊？哪个是小猫咪？我这里一堆文件...”

> ”卸载？删掉文件夹就行了...等等，代理好像没关掉，网断了！救命啊！“

别怕！**Fast Install** 帮你终结这一切！🦸‍♂️

这是一个为开发者设计的绿色软件一键式部署框架。你只需要改改配置，你的用户只需要双击鼠标，就能享受到原生安装包般的顺滑体验。从带进度条的下载到自动创建快捷方式，再到一键清理的干净卸载，我都为你考虑好了！

## ✨ 特性一览

*   **交互式安装**: 提供 `默认安装` 和 `自定义路径` 两种模式，满足不同用户需求。
*   **华丽的下载体验**: 调用 PowerShell 脚本，实现带实时速度和百分比的下载进度条。📈
*   **高度自动化**: 自动解压、创建桌面和开始菜单快捷方式、写入注册表，让你的绿色软件也能在“应用和功能”列表中拥有姓名！
*   **可选的汉化/破解流程**: 内置下载并应用补丁的逻辑，一步到位。
*   **智能卸载**:
    *   自动结束软件进程。
    *   **重置系统代理**，避免卸载后无法上网的尴尬。
    *   **可选保留用户数据**，升级软件或重装时不清空配置。
    *   注册表、快捷方式统统清理干净。
    *   使用自毁脚本完成最终清理，不留一丝痕迹。💨
*   **管理员权限检查**: 自动提示用户以管理员身份运行，避免权限不足导致的各种诡异问题。

## 🔧 使用指南 (开发者看这里)

三步走，把你的软件变成一个优雅的安装包！

### 1. 准备物料 📦

1.  **软件主体**: 将你的绿色软件（如 Clash for Windows）打包成一个 `.zip` 压缩包。
    > **💡 提示**: 你必须在打包软件本体时将Uninstaller放在软件根目录下，否则将无法使用正常手段卸载
2.  **（可选）补丁文件**: 如果你需要汉化或应用其他补丁（如此处的 `app.asar`），也请准备好。

### 2. 上传到服务器 ☁️

你需要一台服务器或对象存储，将上面准备好的文件上传，并获取**可以直接下载的链接 (直链)**。

*   主程序链接: `https://your-server.com/Clash.for.Windows.zip`
*   补丁链接: `https://your-server.com/app.asar`
> **💡 提示**: 如果你没有服务器，可以考虑使用 GitHub Releases, Google Drive, Dropbox 等服务，但请确保链接是直链（直接下载文件），而不是跳转页面。

### 3. 修改配置文件 ✍️

这是最核心的一步！用专业的文本编辑器（如 VS Code, Notepad++）打开 `.bat` 文件进行修改。

#### a. 修改 `install.bat`

在文件顶部的“脚本和应用配置区域”填入你的信息：

```batch
REM =================================================================================
REM                            脚本和应用配置区域
REM =================================================================================
:: 你的软件压缩包下载直链
set "MAIN_DOWNLOAD_URL=https://your-server.com/Clash.for.Windows.zip"

:: 你的补丁文件下载直链
set "PATCH_DOWNLOAD_URL=https://your-server.com/app.asar"

:: 安装完成后自动打开的网页 (例如一个帮助文档)
set "FINAL_WEBSITE_URL=https://your-docs-page.com"

:: 你的软件名字
set "APP_NAME=Clash for Windows"

:: 软件版本号
set "APP_VERSION=0.20.39"

:: 软件发行商
set "APP_PUBLISHER=Clash Dev Team"

:: 软件主程序的文件名 (带.exe)
set "EXECUTABLE_NAME=Clash for Windows.exe"

:: 注册表卸载信息路径 (一般只改最后的APP_NAME部分即可)
set "REG_UNINSTALL_KEY=HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\%APP_NAME%"
REM =================================================================================
```

#### b. 修改 `uninstaller.bat`

**非常重要！** 卸载脚本里的信息必须和安装脚本里的保持一致，否则无法正确清理！

```batch
REM =================================================================================
REM                            应用信息配置
REM =================================================================================
:: 必须和 install.bat 中的 APP_NAME 一致
set "APP_NAME=Clash for Windows"

:: 必须和 install.bat 中的 EXECUTABLE_NAME 一致
set "EXECUTABLE_NAME=Clash for Windows.exe"

:: 必须和 install.bat 中的 REG_UNINSTALL_KEY 一致
set "REG_UNINSTALL_KEY=HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\%APP_NAME%"

:: (此项为 Clash for Windows 的默认用户数据路径，可根据你的软件修改)
set "USER_DATA_PATH=%USERPROFILE%\.config\clash"
REM =================================================================================
```

### 4. 打包分发 🎉

将包含你修改过的 install.bat 以及downloader.ps1打包，发给你的朋友们吧！

打包推荐使用Bat 2 exe，图形化界面，有中文选项，操作友好

## 👨‍💻 给最终用户的话

嘿！拿到这个文件夹后，你只需要：

1.  **右键点击它，选择“以管理员身份运行”**。
2.  根据提示操作，喝杯水，然后就装好啦！🥳

## ⚠️ 关于中文编码的巨坑！(必读)

这是一个老生常谈但又不得不提的问题。如果你在脚本的任何地方（比如文件名、路径、注释）用到了中文，请务必注意文件的编码格式，否则用户那边可能会出现乱码或者脚本报错！😱

**如何检查和修改编码？**

推荐使用强大的文本编辑器，如 `VS Code` 或 `Notepad++`。在编辑器的右下角通常可以查看和切换当前文件的编码。

**一句话总结：改脚本前，先确认编码！**

---

好了，现在你拥有了一套属于自己的、功能强大的软件分发框架。尽情享受创造和分享的乐趣吧！


最后的最后，感谢Google Gemini对本ReadMe文档及代码注释的大力支持！🤖🎉


